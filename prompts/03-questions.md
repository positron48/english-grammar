# Промпт 3: Банк вопросов (Question Bank)

## Роль модели
Ты — составитель тестов и упражнений по грамматике.

## Задача
Сгенерируй question_bank для главы на основе всех theory_blocks.

## Входные параметры
- `chapter_id`: ID главы
- `theory_blocks`: Список всех theory_blocks с их ID и concept_id
- `question_types_needed`: Типы вопросов из плана
- `ui_language`: Язык интерфейса объяснений
- `target_language`: Язык примеров

## Ограничения
- Всего вопросов: минимум 60, рекомендуется 80
- Распределение: по 12–15 вопросов на каждый theory_block_id
- **ВАЖНО: Выбор типов вопросов**
  - Используй только те типы вопросов из `question_types_needed`, которые **ПОДХОДЯТ** для проверки конкретного `theory_block_id`
  - НЕ нужно генерировать все типы вопросов для каждого блока "для количества"
  - Выбирай типы вопросов, которые логично проверяют материал блока:
    - `mcq_single`: один правильный ответ (универсальный, подходит почти везде)
    - `mcq_multi`: несколько правильных ответов (когда нужно проверить понимание нескольких условий/правил)
    - `fill_blank`: вставить форму/слово (когда проверяется знание конкретных форм, окончаний, артиклей)
    - `reorder`: собрать предложение (только если блок касается порядка слов в предложении)
    - `error_spotting`: найти ошибку (когда есть типичные ошибки по теме блока)
    - `true_false`: правда или ложь (для проверки понимания правил/концепций)
  - **Примеры неправильного использования:**
    - `reorder` для блока про артикли (артикли не влияют на порядок слов)
    - `fill_blank` для блока про общие концепции без конкретных форм
    - Все типы вопросов для каждого блока "для покрытия"
  - **Примеры правильного использования:**
    - Для блока про артикли: `mcq_single`, `fill_blank`, `error_spotting` (но НЕ `reorder`)
    - Для блока про порядок слов: `mcq_single`, `reorder`, `error_spotting`
    - Для блока про формы глаголов: `mcq_single`, `fill_blank`, `error_spotting`
- Каждый вопрос содержит:
  - `id`: уникальный ID (q1, q2, ...)
  - `type`: тип вопроса
  - `prompt`: текст задания (Markdown допускается)
  - `theory_block_id`: ID блока, к которому относится вопрос
  - `difficulty`: сложность 1-5
  - `correct_answer`: правильный ответ (формат зависит от типа)
  - `explanation`: объяснение (2–4 предложения, с указанием правила)
- Для `mcq_*`: массив `choices` с `id`, `text`, `feedback` (опционально)
- Для `fill_blank`: строка `correct_answer`
  - **ОБЯЗАТЕЛЬНО для fill_blank**: В конце промпта должны быть скобки с базовой формой слова/слов для подстановки или подсказкой
  - **ЗАПРЕЩЕНО**: Указывать в скобках ту же форму, что в `correct_answer`
  - **ОШИБКА**: Отсутствие скобок в конце prompt
  - Если `correct_answer` уже является базовой формой (например, V1 "go"), в скобках укажи перевод или другую подсказку
  - Примеры:
    - Правильно: `"Заполните пропуск: \"I ___ to London.\" (go)"` → correct_answer: "went"
    - Правильно: `"Заполните пропуск: \"She ___ to work.\" (go)"` → correct_answer: "goes"
    - Правильно: `"Заполните пропуск: \"I ___ to work.\" (ходить, идти)"` → correct_answer: "go" (V1, подсказка в скобках)
    - Неправильно: `"Заполните пропуск: \"I ___ to London.\" (went)"` → correct_answer: "went" (та же форма)
    - Неправильно: `"Заполните пропуск: \"I ___ to London.\""` → отсутствуют скобки (обязательны)
    - Можно несколько вариантов: `"Заполните пропуск: \"I ___ there.\" (go/walk)"` → correct_answer: "went" или "walked"
- Для `reorder`: строка `correct_answer` (полное предложение)
  - **ОБЯЗАТЕЛЬНО для reorder**: В промпте НЕ должно быть квадратных скобок `[...]` со списком слов
  - Все слова для упорядочивания должны браться из `correct_answer`
  - **ОШИБКА**: Наличие квадратных скобок в prompt
  - Примеры:
    - Правильно: `"Расставьте слова в правильном порядке."` → correct_answer: "I go to school every day."
    - Правильно: `"Расставьте слова в правильном порядке: go, I, school, to"` → без квадратных скобок
    - Неправильно: `"Расставьте слова в правильном порядке: [go, I, school, to]"` → квадратные скобки запрещены
- Для `error_spotting`: массив `choices` с вариантами исправления
- Для `true_false`: строка `correct_answer` ("true" или "false")
- Вопросы должны быть вариативными:
  - разная лексика
  - разные контексты (утверждение/отрицание/вопрос)
  - разные "ловушки" (типичные смешения правил)

## Выходной формат
Верни **ТОЛЬКО JSON** без лишнего текста:

```json
{
  "questions": [
    {
      "id": "q1",
      "type": "mcq_single",
      "prompt": "Choose the correct option: **___ you ever ___ sushi?**",
      "theory_block_id": "b1_theory_experience_meaning",
      "difficulty": 2,
      "choices": [
        {
          "id": "a",
          "text": "Did / try",
          "feedback": "Did + V1 usually describes a specific past event."
        },
        {
          "id": "b",
          "text": "Have / tried",
          "feedback": "Yes: Have + V3 is a standard experience question."
        }
      ],
      "correct_answer": "b",
      "explanation": "For experience questions we use Present Perfect: **Have you ever + V3** → Have you ever tried…?",
      "tags": []
    }
  ]
}
```

## Критерии качества
- Вопросы проверяют понимание, а не заучивание
- Вариативность по лексике и контексту
- Объяснения ссылаются на правило из theory_block
- Нет семантически повторяющихся вопросов
- Покрыты все theory_block_id

## СТРОГИЙ ЗАПРЕТ на шаблонные фразы
**ЗАПРЕЩЕНО использовать следующие шаблонные фразы:**
- "Выберите правильный вариант для V1/V2/V3."
- "Заполните пропуск правильной формой для V1/V2/V3."
- "Верно или неверно: V1/V2/V3 важна для понимания грамматики."
- "Расставьте слова в правильном порядке для V1/V2/V3."
- "Объяснение для вопроса о V1/V2/V3."
- Любые другие шаблонные фразы без конкретного содержания

**ОБЯЗАТЕЛЬНО:**
- Каждый `prompt` должен содержать конкретный пример, контекст или предложение
- Каждое `explanation` должно конкретно объяснять правильный ответ с указанием правила
- Используй реальные примеры из theory_block или создавай новые, но конкретные
